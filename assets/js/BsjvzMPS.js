import{defineComponent as Q,useCssVars as re,reactive as G,ref as $,onMounted as J,watch as ie,openBlock as u,createElementBlock as p,createElementVNode as e,normalizeStyle as X,unref as n,toDisplayString as o,pushScopeId as ee,popScopeId as te,resolveComponent as I,resolveDirective as ce,createBlock as B,withCtx as F,withDirectives as ue,createVNode as N,normalizeClass as M,createTextVNode as g,Fragment as O,renderList as T,createCommentVNode as V,createApp as de}from"vue";import{c as pe}from"./CXI0anX6.js";import _e from"element-plus";import he from"element-plus/es/locale/lang/zh-cn";(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))y(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const w of s.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&y(w)}).observe(document,{childList:!0,subtree:!0});function _(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function y(r){if(r.ep)return;r.ep=!0;const s=_(r);fetch(r.href,s)}})();const me="/qweather/assets/webp/Cl_AH2Wx.webp",Z=d=>(ee("data-v-141057ea"),d=d(),te(),d),ye={style:{position:"relative",display:"grid","place-items":"center"}},fe=Z(()=>e("div",{class:"bg-progress-300",style:{position:"absolute",width:"160px",height:"160px"}},null,-1)),ve=Z(()=>e("div",{style:{background:"transparent",width:"8px",height:"8px",border:"4px solid white","border-radius":"100%"}},null,-1)),ge=[ve],we={style:{position:"absolute",display:"grid","place-items":"center center","row-gap":"0.6rem"}},xe=Z(()=>e("div",{style:{"font-size":"16px",color:"#fffffff0"}},"AQI 指数",-1)),be={style:{"font-size":"24px"}},$e={style:{"font-size":"16px"}},Le=Q({__name:"aqiChart",props:{aqi:{},category:{}},setup(d){re(m=>({"4b25970c":_}));const _=`url("${new URL(me,import.meta.url).toString()}")`,y=d,r=G({transformRotateZ:1}),s=$(-44),w=$(224),t=()=>{const m=w.value-s.value,q=y.aqi>300?300*m:y.aqi*m;r.transformRotateZ=q/300+s.value};return J(()=>t()),ie(()=>y.aqi,()=>t()),(m,q)=>(u(),p("div",ye,[fe,e("div",{class:"gauge-pointer",style:X({background:"transparent",width:"164px",height:"18px",transition:"all 0.2s",transform:`rotateZ(${n(r).transformRotateZ}deg)`})},ge,4),e("div",we,[xe,e("div",be,o(m.category),1),e("div",$e,o(m.aqi),1)])]))}}),ne=(d,h)=>{const _=d.__vccOpts||d;for(const[y,r]of h)_[y]=r;return _},Se=ne(Le,[["__scopeId","data-v-141057ea"]]),Ce={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},qe=e("path",{fill:"currentColor",d:"M800 416a288 288 0 1 0-576 0c0 118.144 94.528 272.128 288 456.576C705.472 688.128 800 534.144 800 416M512 960C277.312 746.688 160 565.312 160 416a352 352 0 0 1 704 0c0 149.312-117.312 330.688-352 544"},null,-1),ke=e("path",{fill:"currentColor",d:"M512 448a64 64 0 1 0 0-128a64 64 0 0 0 0 128m0 64a128 128 0 1 1 0-256a128 128 0 0 1 0 256m345.6 192L960 960H672v-64H352v64H64l102.4-256zm-68.928 0H235.328l-76.8 192h706.944z"},null,-1),Pe=[qe,ke];function Re(d,h){return u(),p("svg",Ce,[...Pe])}const De={name:"ep-map-location",render:Re},Ue={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ee=e("path",{fill:"currentColor",d:"M288 896h448q32 0 32 32t-32 32H288q-32 0-32-32t32-32"},null,-1),Ie=e("path",{fill:"currentColor",d:"M800 416a288 288 0 1 0-576 0c0 118.144 94.528 272.128 288 456.576C705.472 688.128 800 534.144 800 416M512 960C277.312 746.688 160 565.312 160 416a352 352 0 0 1 704 0c0 149.312-117.312 330.688-352 544"},null,-1),Ne=e("path",{fill:"currentColor",d:"M512 512a96 96 0 1 0 0-192a96 96 0 0 0 0 192m0 64a160 160 0 1 1 0-320a160 160 0 0 1 0 320"},null,-1),Me=[Ee,Ie,Ne];function Oe(d,h){return u(),p("svg",Ue,[...Me])}const Te={name:"ep-location-information",render:Oe},ze="/qweather/assets/webp/Cc6TtS9Y.webp",i=d=>(ee("data-v-fdfb92f3"),d=d(),te(),d),Ae={class:"grid"},He={key:0,class:"weather"},Ke={class:"current-time"},Be={class:"current-live"},Fe=i(()=>e("div",{class:"placeholder"},null,-1)),Ve={class:"info"},Ge={class:"summary"},Ze={class:"text"},je=["src"],We={key:0,class:"severe"},Ye={class:"current-info"},Qe=i(()=>e("span",null," 风速 ",-1)),Je=i(()=>e("span",null," 相对湿度 ",-1)),Xe=i(()=>e("span",null," 能见度 ",-1)),et=i(()=>e("span",null," 降水量 ",-1)),tt=i(()=>e("span",null," 大气压 ",-1)),nt=i(()=>e("span",null," 露点 ",-1)),ot={class:"hourly"},at=i(()=>e("h3",null,"逐小时预报",-1)),st={class:"daily"},lt=i(()=>e("h3",null,"一周预报",-1)),rt={style:{display:"grid","grid-template-rows":"repeat(2, 1fr)","justify-items":"center"}},it=i(()=>e("br",null,null,-1)),ct=i(()=>e("br",null,null,-1)),ut={class:"indices"},dt=i(()=>e("h3",null,"生活指数",-1)),pt={class:"air",style:{position:"relative"}},_t=i(()=>e("h3",null,"空气质量",-1)),ht=i(()=>e("span",null,"PM10",-1)),mt=i(()=>e("span",null,"PM2.5",-1)),yt=i(()=>e("span",null,"CO",-1)),ft=i(()=>e("span",null,[g("NO"),e("sub",null,"2")],-1)),vt=i(()=>e("span",null,[g("SO"),e("sub",null,"2")],-1)),gt=i(()=>e("span",null,[g("O"),e("sub",null,"3")],-1)),wt=i(()=>e("a",{href:"https://www.qweather.com/",target:"_blank",rel:"noopener noreferrer"}," 天气数据由和风天气提供 ",-1)),xt=i(()=>e("a",{href:"https://qcyblm.deve2.com/",target:"_blank",rel:"noopener noreferrer"},"qcyblm",-1)),bt={key:1},$t=Q({__name:"App",setup(d){const h=$(),_=$(!0),y=new URL(ze,import.meta.url).toString(),r=()=>{const l=new Date().getHours();return l>=6&&l<=18?"d":"n"},s=G({data_domain:"https://devapi.qweather.com/v7",geo:"https://geoapi.qweather.com/v2/city/lookup",privateKey:"0210e1ce58b04de2a285a149b730c36c"}),w=G({data_domain:"https://restapi.amap.com/v3/ip",key:"f51bb1449714b1a497014083a637c388"}),t=$([{text:"obsTime"},{text:"temp"},{text:"feelsLike"},{text:"icon"},{text:"text"},{text:"wind360"},{text:"windDir"},{text:"windScale"},{text:"windSpeed"},{text:"humidity"},{text:"precip"},{text:"pressure"},{text:"vis"},{text:"cloud"},{text:"dew"}]),m=(l,c)=>r()==="d"?l:c,q=l=>`rgba(${pe(l).alpha(.8).rgba()})`,k=$(!1),P=$(),f=async(l,c)=>{try{return l.search=c.toString(),(await fetch(l.toString(),{method:"GET"})).json()}catch{_.value=!1,h.value=!0}},j=async l=>{try{const{adm1:c,adm2:b,name:R,id:A,lon:H,lat:K}=l;t.value.geo=`${c}${R===b?b:`${b}${R}`}`;const v=new URLSearchParams;v.append("location",A),v.append("key",s.privateKey);const x=E=>`${s.data_domain}/${E}`,L=new URLSearchParams;L.append("location",`${H},${K}`),L.append("key",s.privateKey);const S=new URLSearchParams(v);S.append("type","1,2,3,4,5,6,7,8,9");const[C,D,U,a,oe,ae,se]=await Promise.all([f(new URL(x("weather/now")),v),f(new URL(`${s.data_domain}/minutely/5m`),L),f(new URL(x("air/now")),v),f(new URL(x("indices/1d")),S),f(new URL(x("weather/24h")),v),f(new URL(x("weather/7d")),v),f(new URL(x("warning/now")),v)]),le=await C.now;t.value.map(E=>{E.value=le[E.text]}),t.value.updateTime=C.updateTime,t.value.summary=D.summary,t.value.air=U.now,t.value.indices=a.daily,t.value.hourly=oe.hourly,t.value.daily=ae.daily,t.value.warning=se.warning}catch(c){throw console.error(c)}finally{_.value=!1}},W=new URLSearchParams;W.append("key",w.key);const z=async()=>{_.value=!0;const l=await f(new URL(w.data_domain),W);if(typeof l.province=="string"||typeof l.city=="string"){k.value=!1;const c=new URLSearchParams;c.append("location",l.city),c.append("key",s.privateKey),c.append("ad",l.province),P.value=await f(new URL(s.geo),c),await j(P.value.location[0])}else alert("高德地图IP定位失败，请保持经纬度定位，无需再按！")},Y=()=>{if(_.value=!0,navigator.geolocation)navigator.geolocation.getCurrentPosition(async l=>{k.value=!0;const c=new URLSearchParams;c.append("location",`${l.coords.longitude},${l.coords.latitude}`),c.append("key",s.privateKey),P.value=await f(new URL(s.geo),c),await j(P.value.location[0])},l=>{if(l.code===l.PERMISSION_DENIED)return z()});else return z()};return J(()=>Y()),(l,c)=>{const b=Te,R=De,A=I("ElIcon"),H=I("ElTooltip"),K=Se,v=I("ElEmpty"),x=I("ElConfigProvider"),L=ce("loading");return u(),B(x,null,{default:F(()=>{var S,C,D,U;return[e("div",Ae,[n(t).updateTime?ue((u(),p("div",He,[e("header",null,[e("address",null,[N(A,{color:"#fff",onClick:c[0]||(c[0]=()=>n(k)?z():Y())},{default:F(()=>[n(k)?(u(),B(b,{key:0})):(u(),B(R,{key:1}))]),_:1}),e("span",null,o(n(t).geo),1)]),e("span",Ke," 数据观测时间："+o(new Date(n(t).updateTime).toLocaleString("zh-CN",{dateStyle:"full",timeStyle:"short"})),1)]),e("div",Be,[Fe,e("div",Ve,[e("i",{class:M(`qi-${n(t)[3].value}`)},null,2),e("span",null,o(n(t)[1].value)+"℃",1),e("div",Ge,[e("p",null,o(n(t)[4].value),1),e("p",null,"体感温度："+o(n(t)[2].value)+"°",1)]),e("p",Ze,[e("img",{src:n(y),alt:"rain",style:{width:"1.15rem",height:"1.15rem","vertical-align":"middle"}},null,8,je),g(" "+o(n(t).summary),1)])]),n(t).warning?(u(),p("div",We,[(u(!0),p(O,null,T(n(t).warning,a=>(u(),p("div",{class:"weather-icon",style:X(`background-color: ${q(a.severityColor)}`),key:a.id},[N(H,{effect:"dark",content:a.title,placement:"bottom"},{default:F(()=>[e("i",{class:M(`qi-${a.type}`),style:{"font-size":"32px"}},null,2)]),_:2},1032,["content"])],4))),128))])):V("",!0)]),e("div",Ye,[e("p",null,[Qe,e("span",null,o(n(t)[6].value)+" "+o(n(t)[7].value)+"级 ",1)]),e("p",null,[Je,e("span",null,o(n(t)[9].value)+"%",1)]),e("p",null,[Xe,e("span",null,o(n(t)[12].value)+" km",1)]),e("p",null,[et,e("span",null,o(n(t)[10].value)+" mm",1)]),e("p",null,[tt,e("span",null,o(n(t)[11].value)+" hPa",1)]),e("p",null,[nt,e("span",null,o(n(t)[14].value)+"°",1)])]),e("div",ot,[at,e("ul",null,[(u(!0),p(O,null,T(n(t).hourly,a=>(u(),p("li",{key:a.fxTime},[e("p",null,[e("span",null,o(new Date(a.fxTime).toLocaleString("zh-CN",{timeStyle:"short"})),1),e("span",null,[e("i",{class:M(`qi-${a.icon}`)},null,2)]),e("span",null,o(a.text),1),e("span",null,o(a.temp)+"℃ ",1)])]))),128))])]),e("div",st,[lt,e("ul",null,[(u(!0),p(O,null,T(n(t).daily,a=>(u(),p("li",{key:a.fxDate},[e("p",rt,[e("span",null,o(new Date(a.fxDate).toLocaleString(void 0,{month:"short",day:"numeric"})),1),e("span",null,o(new Date(a.fxDate).toLocaleString(void 0,{weekday:"short"})),1)]),e("i",{class:M(`qi-${m(a.iconDay,a.iconNight)}`)},null,2),e("p",null,[e("span",null,[g(o(m(a.textDay,a.textNight))+" ",1),it,g(" "+o(a.tempMin)+"°/"+o(a.tempMax)+"° ",1)]),e("span",null,[g(o(m(a.windDirDay,a.windDirNight))+" ",1),ct,g(" "+o(m(a.windScaleDay,a.windScaleNight))+"级 ",1)])])]))),128))])]),e("div",ut,[dt,e("ul",null,[(u(!0),p(O,null,T(n(t).indices,a=>(u(),p("li",{key:a.name},[e("p",null,[e("span",null,o(a.name),1),e("span",null,o(a.category),1)])]))),128))])]),e("div",pt,[_t,e("ul",null,[e("li",null,[N(K,{aqi:Number((C=(S=n(t))==null?void 0:S.air)==null?void 0:C.aqi),category:(U=(D=n(t))==null?void 0:D.air)==null?void 0:U.category},null,8,["aqi","category"])]),e("li",null,[ht,e("span",null,o(n(t).air.pm10),1)]),e("li",null,[mt,e("span",null,o(n(t).air.pm2p5),1)]),e("li",null,[yt,e("span",null,o(n(t).air.co),1)]),e("li",null,[ft,e("span",null,o(n(t).air.no2),1)]),e("li",null,[vt,e("span",null,o(n(t).air.so2),1)]),e("li",null,[gt,e("span",null,o(n(t).air.o3),1)])])]),e("footer",null,[wt,e("span",null,[g(" © "+o(new Date().getFullYear())+" ",1),xt])])])),[[L,n(_)]]):V("",!0),n(h)?(u(),p("div",bt,[N(v,{description:"暂无数据"})])):V("",!0)])]}),_:1})}}}),Lt=ne($t,[["__scopeId","data-v-fdfb92f3"]]);de(Lt).use(_e,{locale:he}).mount("#app");
